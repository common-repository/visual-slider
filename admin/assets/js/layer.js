(function ($, undefined) {
	  'use strict';
/*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																			 Isset 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/  
	  
	function isset(variable){
		return  variable  !== "undefined" && variable  !== "0" && variable !== null && variable !== '';
	}
	
	function empty(variable){
		if(variable  === "undefined" && variable === null && variable === ''){
			return '';
		}else{
			return variable;
		}
	}
/*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																			 Layer Json 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/  	
	$.fn.vs_layer_json =  function() { 
 			var layer_key  = {};
 		$('.vs_module_layer_item').each(function() {
			var key = $(this).attr('data-key');
 			var id = $(this).attr('data-id');
 			var option = $(this).find('#vs_layer_options').serializeJSON();
  
 			  layer_key[key] = {'id' : id,'option':option };
  		});
		
		return layer_key;
 
  	};
 
/*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																			 sortable layer 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/   	
	$.fn.vs_sortable_layer =  function() { 
  		$('.vs_module_layer_list').sortable({
			handle: ".vs_module_layer_title",
 			opacity: 0.6,
			update: function() {
 				 $('body').vs_reload_layer();
 			}	
			 		
		});
 	}; 
	
  /*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																			 reload layer 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/  
   
   $.fn.vs_reload_layer =  function() { 

	  $('.vs_perview_slide_content').addClass('vs-loading');
	  
	  var data_layer = $('body').vs_layer_json();;
		 setTimeout(function(){  
     		 
  		$.ajax({
			type: 'POST',
  			url: visualslider.ajaxurl,
			data : {
				action : 'vs_perview_layer',
 				layer_json : data_layer,
  			},
			success:function(data) {
 				if(data.length){
				$('.vs_perview_slide_content .vs-perview-slide .vs-layer-warp').remove();
				 $('.vs-perview-slide').append(data);
      				
						$('.vs_perview_slide_content').removeClass('vs-loading');
						$('body').find('.vs_module_layer_item').each(function() {
							$(this).vs_layer_options_perview();
						}); 
					 	$('body').vs_sortable_layer();
						$('body').vs_draggable();
						$('body').vs_coloris();
						$('body').vs_fold_item();
						 
					} else{
					$('body').vs_remove_add_error_loading();
  				}
   			} 
		}); 
		  }, 10);

  };	
	
/*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 																		document Ready
 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/			
   	jQuery(document).ready(function() {
 /*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																			Module Layer
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/	
/* Section Options Update*/
 
	$(document).on('click', '.vs_module_layer_add', function(e) {
  		 $('.vs_add_layer').addClass('vs_add_layer_active'); 	}); 
	
	$(document).on('click', '.vs_add_layer_cancel', function(e) {
  		 $('.vs_add_layer').removeClass('vs_add_layer_active');
 	
	});
	
$(document).on("click",".vs_add_layer_item", function() {
		$(this).parents('.vs_add_layer_content').find('.selected').removeClass('selected');
		$(this).addClass('selected');
 	}); 
		
/*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																			Add Layer
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/	
 	$(document).on('click', '.vs_add_layer_add', function() {
		
		$('body').append('<div class="vs-mouse-wait"></div>');
  		var data_key = 'r'+Math.floor(Math.random() * 9999999999);
		var data_id = $('.vs_add_layer').find('.selected').attr('data-layer');
 
  		var data_tablet=  $('.vs_live_setting_responsive_tablet').find('input:checked').val();
  		var data_mobile=  $('.vs_live_setting_responsive_mobile').find('input:checked').val();
 
  		$.ajax({
			type: 'POST',
  			url: visualslider.ajaxurl,
			data : {
				action : 'vs_module_layer_item',
				layer_key : data_key,
				layer_id :  data_id,
				default :  '1',
	 				vs_tablet :  empty(data_tablet),
 				vs_mobile :  empty(data_mobile),			
				
 			},
			success:function(data) {
 				if(data.length){
					$('.vs_module_layer_list').append(data);
  					$('.vs-mouse-wait').remove();
					$('.vs_add_layer').removeClass('vs_add_layer_active');
					$('body').vs_reload_layer();

     				} else{
					$('body').vs_remove_add_error_loading();
  				}
   			} 
		}); 
  	});	

/*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																		 Layer duplicate
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/	
			function vs_duplicate(row,key,adress) {	
		$(adress).attr('data-key',key).attr('id',"vs_"+row+"_"+ key);
 	}
	jQuery(document).on("click",".vs_module_layer_duplicate",function(){
   
   		var duplicate = $(this).parents(".vs_module_layer_item").addClass('vs_duplicate').clone();
		$(this).parents('.vs_duplicate').removeClass('vs_duplicate');
		$(this).parents(".vs_module_layer_item ").after(duplicate);
 		var layer_key = 'r'+Math.floor(Math.random() * 9999999999);
  		vs_duplicate('module_layer',layer_key,'.vs_duplicate');
 		$('.vs_duplicate').removeClass('vs_duplicate');
		
 		$('body').vs_reload_layer();	
 
 }); 

 /*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																		 Layer Active
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/	
		
	$(document).on('click', '.vs_module_layer_title ', function() {
		
  		 $(this).parents('.vs_panel').find('.vs_module_side_options_active,.vs_module_slide_options_active').removeClass('vs_module_side_options_active vs_module_slide_options_active');
   		 $(this).parents('.vs_module_layer_item').addClass('vs_module_side_options_active');
  		 $(this).parents('.vs_panel').addClass('vs_panel_options_active');
 		 
  		 $(this).parents('.vs_panel').find('.vs_draggable_active').removeClass('vs_draggable_active');
  		 var data_key = $(this).parents('.vs_module_layer_item').attr('data-key');
		  $('#vs_perview_layer_'+data_key).addClass('vs_draggable_active');
		  		$('.vs_module_side_options_active').vs_fold_item();
				
 
 	
	
	});
 		
  /*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																		 Layer Close
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/	
	$(document).on('click', '.vs_module_side_options_close', function() {
  		 $(this).parents('.vs_panel').find('.vs_module_side_options_active,.vs_module_slide_options_active').removeClass('vs_module_side_options_active vs_module_slide_options_active');
   		  $(this).parents('.vs_panel_options_active').removeClass('vs_panel_options_active');
  	});		
	$(document).on('click', '.vs_perview_slide  .vs-slide-cover', function(e) {
		$('.vs_draggable_active').removeClass('vs_draggable_active');
		$('.vs_module_side_options_active').removeClass('vs_module_side_options_active');
		$('.vs_panel_options_active').removeClass('vs_panel_options_active');
 
	});
  /*************************************************************************************************************************************************************************
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 																		 Layer Remove
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------
**************************************************************************************************************************************************************************/	
				
		 
	  $(document).on('click', '.vs_module_layer_remove', function() {
  		 $(this).parents('.vs_module_layer_item').remove();
 			var key =$(this).parents('.vs_module_layer_item').attr('data-key');
 		$('.vs_module_side_options_active').removeClass('vs_module_side_options_active');
		$('.vs_panel_options_active').removeClass('vs_panel_options_active');
 
		$('#vs_perview_layer_'+key).remove();
 	
	});  
  
function vs_align_change(type,position) {	
 	 $(document).on('click', ".vs_live_layer_"+type+"align_"+position+" label", function(e) {
		 var val = $(this).find('input').val();
		 if(isset(val)){
 		 $(this).parents('.vs_side_options_content').find( ".vs_live_layer_"+type+"position_"+position+" input" ).text('0').val('0');
		 }else{
 		 $(this).parents('.vs_side_options_content').find( ".vs_live_layer_"+type+"position_"+position+" input" ).text('').val('');
		 }
		$(this).parents('.vs_side_options_content').vs_layer_postion_size();

	});
}
vs_align_change('','horizontal');
vs_align_change('','vertical');
vs_align_change('tablet_','horizontal');
vs_align_change('tablet_','vertical');
vs_align_change('mobile_','horizontal');
vs_align_change('mobile_','vertical');
  
$(document).on('click','.vs_panel_title',function() {
 		 $('body').vs_layer_json();
 });
 
 
 
 
 
 
 });  
	
	
})(jQuery);

		